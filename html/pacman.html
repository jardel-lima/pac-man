<!DOCTYPE html>
<html>
<head>
	<title>Pac Man</title>
	<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
	<meta content="utf-8" http-equiv="encoding">
    <link rel="stylesheet" type="text/css" href="../css/pacman.css">
    <script type="text/javascript" src="../javascript/variables.js"></script>
    <script type="text/javascript" src="../javascript/auxiliary.js"></script>
    <script type="text/javascript" src="../javascript/Pacman.js"></script>
    <script type="text/javascript" src="../javascript/Ghost.js"></script>
    <script type="text/javascript" src="../javascript/Game.js"></script>
     <script type="text/javascript" src="../javascript/fileReader.js"></script>
</head>
<body onload="loadNextPhase();"> 
    <div class="divInfo" id="divInfo">
        <div>Map: <div class="edtWhite"><span id="map"> </span></div></div>
        <div>Score: <div class="edtWhite"><span id="score"> 0</span></div></div>
        <div>Lives:<div class="edtWhite"><span id="lives"> </span></div></div>
        <div>Time: <div class="edtWhite"><span id="time"> </span></div></div>
        
    </div>
    <div id="divGame"></div>
    <div class="divFoot" id="divFoot">
        <a href="mainMenu.html"><div class="divButton">Return Menu</div></a>
        <div class="divButton" onclick="game.restart();">Restart Game</div>
        <div class="divButton" id="nextPhase" onclick="loadNextPhase();" >Next Phase</div>
    </div>
	<script>
	
	var game = new Game();
        //var map = readFile("maps/map1.txt");
	var map = 	"00000000000000000000"+
				  	"0                  0"+
					"0 0000000  0000000 0"+
					"0       0        0 0"+
					"0 0000000  0000000 0"+
					"0 0        0       0"+
					"0 0000000  0000000 0"+
					"0       0        0 0"+
					"0 0000000  0000000 0"+
					"0 0        0       0"+
					"0 0000000  0000000 0"+
					"0                  0"+
					"0 0000000000000000 0"+
					"0      0eeee000000 0"+
					"0 000000GGGG0      0"+
					"0      0eeee000000 0"+
					"0 0000000000000000 0"+
					"0                  0"+
					"0 0000000  0000000 0"+
					"0       0        0 0"+
					"0 0000000  0000000 0"+
					"0 0        0       0"+
					"0 0000000  0000000 0"+
					"0       0        0 0"+
					"0 0000000  0000000 0"+
					"0 0        0       0"+
					"0 0000000  0000000 0"+
					"0 00  000    000   0"+
					"0                  0"+
					"00000000000000000000";
	game.initiate(map);
         
        
	printMatrix();
	
	//keyboard events----------------------------------------------------
		document.onkeydown = checkKey;
		function checkKey(e) {

			e = e || window.event;

			if (e.keyCode == '38') {
				// up arrow
				//console.log("Up");
				if(game.status=="STOP")
					game.status = "PLAY";
				
				if(game.status=="PLAY"  && pacman.direction!="UP"){
					if(MATRIX[pacman.positionY-1][pacman.positionX]!=WALL){
						pacman.direction = "UP";
					}
					pacman.move();
				}	
				
				
			}
			else if (e.keyCode == '40') {
				// down arrow
				//console.log("Down");
				if(game.status=="STOP")
					game.status = "PLAY";
				
				if(game.status=="PLAY" && pacman.direction!="DOWN"){
					if(MATRIX[pacman.positionY+1][pacman.positionX]!=WALL){
						pacman.direction = "DOWN";
					}
					pacman.move();
				}	
			}
			else if (e.keyCode == '39') {
				// right arrow
				//console.log("Right");
				if(game.status=="STOP")
					game.status = "PLAY";
				
				if(game.status=="PLAY"  && pacman.direction!="RIGHT"){
					if(MATRIX[pacman.positionY][pacman.positionX+1]!=WALL){
						pacman.direction = "RIGHT";
					}
					pacman.move();
				}	
			}
			else if (e.keyCode == '37') {
				// left arrow
				//console.log("Left");
				if(game.status=="STOP" )
					game.status = "PLAY";
				
				if(game.status=="PLAY"  && pacman.direction!="LEFT"){
					if(MATRIX[pacman.positionY][pacman.positionX-1]!=WALL){
						pacman.direction = "LEFT";
					}
					pacman.move();
					
				}	
				
			}
			
		}
                function loadNextPhase(){
                    game.phase++;                    
                    mapFile="map"+game.phase+".txt";
                    loadFile(mapFile);
                    game.changePhase();
                    
                }
		//Loop-------------------------
		var loop = function(){
			
				 game.gameController(pacman, ghost1, ghost2, ghost3, ghost4);
				
				 document.getElementById('score').innerHTML=game.score;
				 document.getElementById('lives').innerHTML=pacman.lives; 
				 document.getElementById('time').innerHTML=game.time;
				 
                           
		}
		
		setInterval(loop,250);
		
		var time = function(){
			if(game.status=="PLAY")
					game.time++;
		}
		
		setInterval(time,1000);
		
		
	
	
		
	</script>
        <div id="divDataMap"></div>
</body>
</html>
